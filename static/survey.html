<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stress Survey | Stress App</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background:
        linear-gradient(rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.12)),
        url("/static/bg.png") no-repeat center center/cover;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    nav {
      width: 100%;
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(12px);
      padding: 16px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .logo {
      font-size: 26px;
      font-weight: bold;
      color: #2343e1;
    }

    .nav-links {
      display: flex;
      gap: 22px;
    }

    .nav-links a {
      text-decoration: none;
      font-size: 15px;
      color: #111;
      font-weight: 500;
      padding: 8px 14px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .nav-links a:hover {
      background-color: #2343e1;
      color: white;
      box-shadow: 0 4px 12px rgba(35, 67, 225, 0.4);
    }

    .main {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.28);
      backdrop-filter: blur(18px);
      border-radius: 20px;
      padding: 30px 20px;
      width: 100%;
      max-width: 700px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
      color: #111;
    }

    h1 {
      text-align: center;
      margin-bottom: 25px;
      font-size: 28px;
      color: #2343e1;
    }

    .question {
      margin-bottom: 15px;
    }

    label {
      font-weight: 500;
      display: block;
      margin-bottom: 5px;
    }

    select {
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: none;
      font-size: 15px;
    }

    button {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      background-color: #2343e1;
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(35, 67, 225, 0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 25px rgba(35, 67, 225, 0.5);
    }

    #result {
      margin-top: 20px;
      background: rgba(255,255,255,0.3);
      padding: 15px;
      border-radius: 12px;
      font-size: 16px;
      text-align: center;
    }

    .survey-btn {
      display: inline-block;
      margin-top: 20px;
      width: 100%;
      text-align: center;
      background-color: #2343e1;
      color: white;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 10px;
      text-decoration: none;
      box-shadow: 0 4px 16px rgba(35, 67, 225, 0.3);
      transition: background 0.3s ease, transform 0.3s ease;
    }

    .survey-btn:hover {
      background-color: #102dc4;
      transform: scale(1.03);
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav>
    <div class="logo">StressSense</div>
    <div class="nav-links">
      <a href="home.html">Home</a>
      <a href="/webcam">Webcam Detection</a>
      <a href="/voice">Voice Analysis</a>
      <a href="logout.php">Logout</a>
    </div>
  </nav>

  <!-- Main Survey Section -->
  <div class="main">
    <div class="container">
      <h1>üß† Stress Survey</h1>
      <form id="surveyForm">
        <!-- Questions will be added dynamically -->
      </form>
      <button type="button" onclick="calculateStress()">Submit</button>
      <div id="result"></div>
      <a href="http://127.0.0.1:5001" target="_blank" class="survey-btn">Next ‚Üí Voice Detection</a>
    </div>
  </div>

  <script>
    const questions = [
      "How often do you feel anxious or nervous without a clear reason?",
      "Do you experience sudden mood swings or emotional outbursts?",
      "How frequently do you feel overwhelmed by your responsibilities?",
      "Do you often feel tired or fatigued even after resting?",
      "How frequently do you have headaches, stomach aches, or other unexplained pain?",
      "Do you have trouble sleeping or wake up feeling unrested?",
      "Do you find it difficult to focus or concentrate for long periods?",
      "How often do you feel forgetful or mentally drained?",
      "Do you find it hard to make decisions, even simple ones?",
      "Have you noticed changes in your eating habits?",
      "Do you find yourself procrastinating or avoiding tasks?",
      "Do you engage in habits like nail-biting or fidgeting?",
      "Have you been avoiding social interactions lately?",
      "Do you feel people don‚Äôt understand what you‚Äôre going through?",
      "Do you feel like you're pretending to be okay when you're not?"
    ];

    const form = document.getElementById('surveyForm');

    questions.forEach((q, index) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <label for="q${index}">${index + 1}. ${q}</label>
        <select id="q${index}" name="q${index}">
          <option value="1">1 - Never</option>
          <option value="2">2 - Rarely</option>
          <option value="3" selected>3 - Sometimes</option>
          <option value="4">4 - Often</option>
          <option value="5">5 - Always</option>
        </select>
      `;
      form.appendChild(div);
    });

    async function calculateStress() {
      const answers = [];
      for (let i = 0; i < questions.length; i++) {
        const val = parseInt(document.getElementById(`q${i}`).value);
        answers.push(val);
      }

      const response = await fetch('http://127.0.0.1:5002/submit_survey', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ answers: answers })
      });

      const result = await response.json();

      if (result.status === "success") {
        document.getElementById("result").innerHTML = `
          ‚úÖ Your Total Score: <strong>${result.total}</strong> / 75<br>
          üìä Stress Percentage: <strong>${result.percent}%</strong><br>
          üß† Stress Level: <strong>${result.level}</strong>
        `;
        localStorage.setItem("survey_result", result.level);
      } else {
        document.getElementById("result").innerHTML = `‚ùå Error: ${result.error}`;
      }
    }
  </script>
</body>
</html>
